<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Calculate sap flux density — tdm_cal.sfd • TREX</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate sap flux density — tdm_cal.sfd"><meta property="og:description" content="The acquired \(K\) values are calculated to sap flux density
 (\(SFD\) in \(cm^3 cm^{-2} h^{-1}\)). As many calibration curves exist
 (see Peters et al. 2018; Flo et al. 2019), the function provides the option to
 calculate \(SFD\) using calibration experiment data from the meta-analyses by
 Flo et al. (2019; see cal.data). Additionally,
 raw calibration data can be provided or parameters \(a\) and \(b\)
 for a specific calibration function (\(aK^b\)) can be provided.
 The algorithm determines for each calibration experiment dataset
 the calibration curve (\(SFD = aK^b\)) and calculates \(SFD\) from
 either the mean of all curves and the 95% confidence interval
 of either all curves, or bootstrapped resampled uncertainty around
 the raw calibration experiment data when one calibration dataset is selected."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TREX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/the-Hull/TREX/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Calculate sap flux density</h1>
    <small class="dont-index">Source: <a href="https://github.com/the-Hull/TREX/blob/HEAD/R/tdm_cal.sfd.R" class="external-link"><code>R/tdm_cal.sfd.R</code></a></small>
    <div class="hidden name"><code>tdm_cal.sfd.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The acquired \(K\) values are calculated to sap flux density
 (\(SFD\) in \(cm^3 cm^{-2} h^{-1}\)). As many calibration curves exist
 (see Peters <em>et al</em>. 2018; Flo <em>et al.</em> 2019), the function provides the option to
 calculate \(SFD\) using calibration experiment data from the meta-analyses by
 Flo <em>et al.</em> (2019; see <code><a href="cal.data.html">cal.data</a></code>). Additionally,
 raw calibration data can be provided or parameters \(a\) and \(b\)
 for a specific calibration function (\(aK^b\)) can be provided.
 The algorithm determines for each calibration experiment dataset
 the calibration curve (\(SFD = aK^b\)) and calculates \(SFD\) from
 either the mean of all curves and the 95% confidence interval
 of either all curves, or bootstrapped resampled uncertainty around
 the raw calibration experiment data when one calibration dataset is selected.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tdm_cal.sfd</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  <span class="va">genus</span>,</span>
<span>  <span class="va">species</span>,</span>
<span>  <span class="va">study</span>,</span>
<span>  <span class="va">wood</span>,</span>
<span>  <span class="va">calib</span>,</span>
<span>  <span class="va">a</span>,</span>
<span>  <span class="va">b</span>,</span>
<span>  <span class="va">decimals</span>,</span>
<span>  make.plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  df <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input</dt>
<dd><p>An <code><a href="is.trex.html">is.trex</a></code>-compliant object (<code>zoo</code> vector,
<code>data.frame</code>) of \(K\) values containing a timestamp and a value column.</p></dd>


<dt>genus</dt>
<dd><p>Optional, character vector specifying genus-specific calibration
data that should be used (e.g., <code>c("Picea", "Larix")</code>). See <code><a href="cal.data.html">cal.data</a></code>
for the specific labels (default = Use all).</p></dd>


<dt>species</dt>
<dd><p>Optional, character vector of species specific calibration data that should be used,
e.g. <code>c("Picea abies")</code>. See <code><a href="cal.data.html">cal.data</a></code> for the specific labels (default = Use all).</p></dd>


<dt>study</dt>
<dd><p>Optional character vector of study specific calibration data that
should be used (e.g., <code>c("Peters et al. 2018"</code>) ). See <code><a href="cal.data.html">cal.data</a></code>
for the specific labels (default= Use all).</p></dd>


<dt>wood</dt>
<dd><p>Optional, character vector of wood type specific calibration
data that should be used (one of <code>c("Diffuse-porous", "Ring-porous", "Coniferous")</code>).
See <code><a href="cal.data.html">cal.data</a></code> for the specific labels (default= Use all).</p></dd>


<dt>calib</dt>
<dd><p>Optional <code>data.frame</code> containing raw calibration experiment values.
Required columns include: <code>[ ,1]</code> \(K = K\) values measured with the probe (numeric),
and [,2] \(SFD =\) Gravimetrically measured sap flux density (\(cm^3 cm^{-2} h^{-1}\))) (numeric).
If not provided, literature values are used.</p></dd>


<dt>a</dt>
<dd><p>Optional, numeric value for the calibration curve (\(SFD = aK^b\)).
No uncertainty can be calculated when this value is provided.</p></dd>


<dt>b</dt>
<dd><p>Optional, numeric value for the calibration curve (\(SFD = aK^b\)).
No uncertainty can be calculated when this value is provided.</p></dd>


<dt>decimals</dt>
<dd><p>Integer, the number of decimals of the output (default = 6).</p></dd>


<dt>make.plot</dt>
<dd><p>Logical; if <code>TRUE</code>, a plot is generated showing
the calibration curve with \(K vs sap flux density\) (\(cm^3 cm^{-2} h^{-1}\))).</p></dd>


<dt>df</dt>
<dd><p>Logical; If <code>TRUE</code>, output is provided in a <code>data.frame</code> format
with a timestamp and a value column. If <code>FALSE</code>, output
is provided as a <code>zoo</code> vector object (default = FALSE).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing either a <code>zoo</code> object or <code>data.frame</code> in the appropriate format
 for other functionalities (see <code><a href="tdm_dt.max.html">tdm_dt.max</a></code> output specifications), as well as
 all \(SFD\) values for each method are provided and added to the</p>
<p></p>
<p><code><a href="is.trex.html">is.trex</a></code>-compliant object (e.g., [['sfd.pd']], [['sfd.mw']])
 if this format was provided as an input, and,
 finally, a <code>data.frame</code> is provided with the mean and 95% confidence
 interval of the applied calibration functions (see [['model.ens']]).
 If an individual time series is provided for input with \(K\) values an alternative output is provided:</p>
<p></p>
<dl><dt>input</dt>
<dd><p>K values provided as input.</p></dd>

   <dt>sfd.input</dt>
<dd><p>\(SFD\) values calculated for the input according to the mean of the calibration function.</p></dd>

   <dt>model.ens</dt>
<dd><p>A <code>data.frame</code> providing the mean and 95% confidence interval of the applied calibration function.</p></dd>

   <dt>out.param</dt>
<dd><p>A <code>data.frame</code> with the coefficients of calibration function.</p></dd>

 
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The function fits a calibration curve (\(SFD = aK^b\))
through all selected raw calibration data. If multiple studies are provided,
multiple calibration curves are fitted. In case a single calibration dataset
is provided a bootstrap resampling is applied (n = 100) to determined the
mean and 95% confidence interval of the fit. When multiple calibration curves
are requested the mean and 95% confidence interval is determined on the fitted functions.
The mean and confidence interval are used to calculate \(SFD\) from \(K\).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Peters RL, Fonti P, Frank DC, Poyatos R, Pappas C, Kahmen A, Carraro V, Prendin AL, Schneider L, Baltzer JL,
 Baron-Gafford GA, Dietrich L, Heinrich I, Minor RL, Sonnentag O, Matheny AM, Wightman MG, Steppe K. 2018.
 Quantification of uncertainties in conifer sap flow measured with the thermal dissipation method.
 New Phytologist 219:1283-1299 <a href="https://doi.org/10.1111/nph.15241" class="external-link">doi:10.1111/nph.15241</a></p>
<p>Flo V, Martinez-Vilalta J, Steppe K, Schuldt B, Poyatos, R. 2019.
 A synthesis of bias and uncertainty in sap flow methods.
 Agricultural and Forest Meteorology 271:362-374 <a href="https://doi.org/10.1016/j.agrformet.2019.03.012" class="external-link">doi:10.1016/j.agrformet.2019.03.012</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">#calculating sap flux density</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">raw</span>   <span class="op">&lt;-</span><span class="fu"><a href="is.trex.html">is.trex</a></span><span class="op">(</span><span class="fu"><a href="example.data.html">example.data</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"doy"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    tz<span class="op">=</span><span class="st">"GMT"</span>,time.format<span class="op">=</span><span class="st">"%H:%M"</span>,</span></span>
<span class="r-in"><span>    solar.time<span class="op">=</span><span class="cn">TRUE</span>,long.deg<span class="op">=</span><span class="fl">7.7459</span>,</span></span>
<span class="r-in"><span>    ref.add<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span><span class="fu"><a href="dt.steps.html">dt.steps</a></span><span class="op">(</span>input<span class="op">=</span><span class="va">raw</span>,start<span class="op">=</span><span class="st">"2014-05-08 00:00"</span>,</span></span>
<span class="r-in"><span>end<span class="op">=</span><span class="st">"2014-07-25 00:50"</span>,</span></span>
<span class="r-in"><span>     time.int<span class="op">=</span><span class="fl">15</span>,max.gap<span class="op">=</span><span class="fl">60</span>,decimals<span class="op">=</span><span class="fl">10</span>,df<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">input</span><span class="op">&lt;</span><span class="fl">0.2</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span><span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span><span class="fu"><a href="tdm_dt.max.html">tdm_dt.max</a></span><span class="op">(</span><span class="va">input</span>, methods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pd"</span>,<span class="st">"mw"</span>,<span class="st">"dr"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>     det.pd<span class="op">=</span><span class="cn">TRUE</span>,interpolate<span class="op">=</span><span class="cn">FALSE</span>,max.days<span class="op">=</span><span class="fl">10</span>,df<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">output.data</span><span class="op">&lt;-</span><span class="fu">tdm_cal.sfd</span><span class="op">(</span><span class="va">input</span>,make.plot<span class="op">=</span><span class="cn">TRUE</span>,df<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>wood<span class="op">=</span><span class="st">"Coniferous"</span>, decimals <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">output.data</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">output.data</span><span class="op">$</span><span class="va">sfd.pd</span><span class="op">$</span><span class="va">sfd</span>,ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">output.data</span><span class="op">$</span><span class="va">sfd.pd</span><span class="op">$</span><span class="va">q025</span>,lty<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">output.data</span><span class="op">$</span><span class="va">sfd.pd</span><span class="op">$</span><span class="va">q975</span>,lty<span class="op">=</span><span class="fl">1</span>,col<span class="op">=</span><span class="st">"grey"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">output.data</span><span class="op">$</span><span class="va">sfd.pd</span><span class="op">$</span><span class="va">sfd</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">output.data</span><span class="op">$</span><span class="va">out.param</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard Peters, Christoforos Pappas, Alexander Hurley, Kathy Steppe.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

