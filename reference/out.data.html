<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Generating TDM output — out.data • TREX</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Generating TDM output — out.data"><meta property="og:description" content='Generates relevant outputs from the sap flux density (SFD) values.
This function provides both \(F_{d}\) (\(SFD\) expressed in \(mmol m^{-2} s^{-1}\)) and crown conductance values
(\(G_{C}\); an analogue to stomatal conductance) in an easily exportable format.
Additionally, the function can perform environmental filtering on \(F_{d}\) and \(G_{C}\) and model \(G_{C}\) sensitivity to vapour pressure deficit (VPD).
The user can choose between in- (method = "env.filt") or excluding (method = "stat") environmental filtering
on the \(G_{C}\) and adjust the filter threshold manually.'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">TREX</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/the-Hull/TREX/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generating TDM output</h1>
    <small class="dont-index">Source: <a href="https://github.com/the-Hull/TREX/blob/HEAD/R/out.data.R" class="external-link"><code>R/out.data.R</code></a></small>
    <div class="hidden name"><code>out.data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Generates relevant outputs from the sap flux density (SFD) values.
This function provides both \(F_{d}\) (\(SFD\) expressed in \(mmol m^{-2} s^{-1}\)) and crown conductance values
(\(G_{C}\); an analogue to stomatal conductance) in an easily exportable format.
Additionally, the function can perform environmental filtering on \(F_{d}\) and \(G_{C}\) and model \(G_{C}\) sensitivity to vapour pressure deficit (VPD).
The user can choose between in- (<code>method = "env.filt"</code>) or excluding (<code>method = "stat"</code>) environmental filtering
on the \(G_{C}\) and adjust the filter threshold manually.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">out.data</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  <span class="va">vpd.input</span>,</span>
<span>  <span class="va">sr.input</span>,</span>
<span>  <span class="va">prec.input</span>,</span>
<span>  peak.hours <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span><span class="op">:</span><span class="fl">14</span><span class="op">)</span>,</span>
<span>  low.sr <span class="op">=</span> <span class="fl">150</span>,</span>
<span>  peak.sr <span class="op">=</span> <span class="fl">300</span>,</span>
<span>  vpd.cutoff <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  prec.lim <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"env.filt"</span>,</span>
<span>  max.quant <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  make.plot <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>input</dt>
<dd><p>An <code><a href="is.trex.html">is.trex</a></code>-compliant time series from <code><a href="tdm_cal.sfd.html">tdm_cal.sfd</a></code> outputs
(e.g., <code>X$sfd.mw$sfd</code>)</p></dd>


<dt>vpd.input</dt>
<dd><p>An <code><a href="is.trex.html">is.trex</a></code>-compliant object an individual series of VPD in kPa (see vpd).
The extent and temporal resolution should be equal to input.
Use <code><a href="dt.steps.html">dt.steps</a></code> to correct if needed.</p></dd>


<dt>sr.input</dt>
<dd><p>An <code><a href="is.trex.html">is.trex</a></code>-compliant object of an individual series of solar irradiance
(e.g. either PAR or global radiation; see <code><a href="sr.html">sr</a></code>).
 The extent and temporal resolution should be equal to input. Use <code><a href="dt.steps.html">dt.steps</a></code> to correct if needed.
 This data is only needed when applying the "env.filt" method.</p></dd>


<dt>prec.input</dt>
<dd><p>An <code><a href="is.trex.html">is.trex</a></code>-compliant object of daily precipitation in mm d-1 (see <code><a href="preci.html">preci</a></code>).
The extent should be equal to input with a daily temporal resolution.
 Use <code><a href="dt.steps.html">dt.steps</a></code> to correct if needed.
 This data is only needed when applying the "env.filt" method.</p></dd>


<dt>peak.hours</dt>
<dd><p>Numeric vector with hours which should be considered as peak-of-the-day hours
(default = <code>c(10:14)</code>).
This variable is only needed when the "stat" method is selected.</p></dd>


<dt>low.sr</dt>
<dd><p>Numeric threshold value in the unit of the sr.input time-series (e.g., W m-2)
to exclude cloudy days which impact \(G_{C}\) (default = 150 W m-2).
 This variable is only needed when the "env.filt" method is selected.</p></dd>


<dt>peak.sr</dt>
<dd><p>Numeric threshold value in the unit of the sr.input time-series (e.g., W m-2)
to exclude hours which are not considered as peak-of-the-day hours (default = 300 W m-2).
This variable is only needed when the "env.filt" method is selected.</p></dd>


<dt>vpd.cutoff</dt>
<dd><p>Numeric threshold value in kPa for peak-of-the-day mean VPD to eliminate unrealistic
and extremely high values of \(G_{C}\) due to low VPD values or high values of \(G_{C}\) (default = 0.5 kPa).</p></dd>


<dt>prec.lim</dt>
<dd><p>Numeric threshold value in mm d-1 for daily precipitation to remove rainy days (default = 1 mm d-1).
This variable is only needed when "env.filt" method is selected.</p></dd>


<dt>method</dt>
<dd><p>Character string indicating whether precipitation and solar irradiance data should be used
to determined peak-of-the-day \(G_{C}\) values and filter the daily \(G_{C}\) values ("env.filt")
 or not ("stat"; default). When <code>"env.filt"</code> is selected, <code>input</code>, <code>vpd.input</code>, <code>sr.input</code>, <code>prec.input</code>,
  <code>peak.sr</code>, <code>low.sr</code>, <code>vpd.cutoff</code> and <code>prec.lim</code> have to be provided.
  When <code>"stat"</code> is selected only <code>input</code>, <code>vpd.input</code> and <code>peak.hours</code>.</p></dd>


<dt>max.quant</dt>
<dd><p>Numeric, defining the quantile of the \(G_{C}\) data which should be considered as GC.max (default = 1).</p></dd>


<dt>make.plot</dt>
<dd><p>Logical; if <code>TRUE</code>, a plot is generated presenting the response of \(G_{C}\) to VPD.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A named list of <code>data.frame</code> objects,
 containing the following items:</p>


<dl><dt>raw</dt>
<dd><p>A <code>data.frame</code> containing the input data and filtered values. Columns include the timestamp [,"timestamp"]
(e.g., "2012-01-01 00:00:00"), year of the data [,"year"], day of year [,"doy"], input solar radiance data [,"sr"],
 daily average radiance data [,"sr"], input vapour pressure deficit data [,"vpd"], isolated peak-of-the-day vapour pressure
 deficit values [,"vpd.filt"], input daily precipitation [,"prec.day"], sap flux density expressed in mmol m-2 s-1 [,"fd"],
 crown conductance expressed in mmol m-2 s-1 kPa-1 [,"gc"], and the filtered crown conductance [,"gc.filt"]</p></dd>


 <dt>peak.mean</dt>
<dd><p>A <code>data.frame</code> containing the daily mean crown conductance values.
 Columns include the timestamp [,"timestamp"] (e.g., "2012-01-01"), peak-of-the-day vapour pressure deficit [,"vpd.filt"],
  the filtered crown conductance mmol m-2 s-1 kPa-1 [,"gc.filt"], and the normalized crown conductance according
   to the maximum crown conductance [,"gc.norm"].</p></dd>


  <dt>sum.mod</dt>
<dd><p>A model summary object (see <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a>()</code>)
   of the model between VPD and \(G_{C}\).</p></dd>



   <dt>sum.mod.norm</dt>
<dd><p>A model summary object (see <code><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a>()</code>)
   of the model between VPD and \(G_{C}\)/\(GC.max\).</p></dd>





</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Various relevant outputs can be derived from the SFD data.
This function provides the option to recalculate SFD to \(F_{d}\) (expressed in mmol m-2 s-1)
and crown conductance (according to Pappas <em>et al.</em> 2018).
\(G_{C}\) is estimated per unit sapwood area, where \(G_{C} = F_{d} / VPD\) (in kPa), assuming that
i) the stem hydraulic capacitance between the height of sensor and the leaves is negligible, and
ii) that the canopy is well coupled to the atmosphere. In order to reduce the effect of stem hydraulic capacitance,
peak-of-the-day \(G_{C}\) are solely considered for calculating daily average \(G_{C}\).
Peak-of-the-day conditions are defined by <code>peak.hours</code> or <code>peak.sr</code>. Moreover, to analyse the relationship between \(G_{C}\)
 and environmental measurements (e.g., VPD), the daily mean peak-of-the-day \(G_{C}\) values can be restricted to:
 i) non-cloudy days (see <code>low.sr</code>), to reduce the impact of low irradiance on \(G_{C}\),
 ii) non-rainy days (see <code>prec.lim</code>), as wet leaves are not well coupled to the atmosphere, and
 iii) daily mean peak-of-the-day \(G_{C}\) great then a threshold (see <code>vpd.cutoff</code>),
 to eliminate unrealistically high \(G_{C}\) values due to low \(F_{d}\) or VPD values (when method = <code>"env.filt"</code>).
 Moreover, the sensitivity of the daily mean peak-of-the-day \(G_{C}\) to VPD is modelled by fitting the following model:</p>
<p>$$G_{C} = \alpha + \beta VPD^{-0.5}$$</p>
<p>Besides using the raw daily mean peak-of-the-day \(G_{C}\) values, the function also applies
  a normalization where daily mean peak-of-the-day \(G_{C}\) is standardized to the maximum conductance (GC.max; see <code>max.quant</code>).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">#Gc response function</span></span></span>
<span class="r-in"><span><span class="co">#Gc response function</span></span></span>
<span class="r-in"><span><span class="va">raw</span>   <span class="op">&lt;-</span> <span class="fu"><a href="is.trex.html">is.trex</a></span><span class="op">(</span><span class="fu"><a href="example.data.html">example.data</a></span><span class="op">(</span>type<span class="op">=</span><span class="st">"doy"</span><span class="op">)</span>, tz<span class="op">=</span><span class="st">"GMT"</span>,</span></span>
<span class="r-in"><span>                 time.format<span class="op">=</span><span class="st">"%H:%M"</span>, solar.time<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                 long.deg<span class="op">=</span><span class="fl">7.7459</span>, ref.add<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="dt.steps.html">dt.steps</a></span><span class="op">(</span>input<span class="op">=</span><span class="va">raw</span>, start<span class="op">=</span><span class="st">"2013-05-01 00:00"</span>, end<span class="op">=</span><span class="st">"2013-11-01 00:00"</span>,</span></span>
<span class="r-in"><span>                   time.int<span class="op">=</span><span class="fl">15</span>, max.gap<span class="op">=</span><span class="fl">60</span>, decimals<span class="op">=</span><span class="fl">10</span>, df<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">input</span><span class="op">&lt;</span><span class="fl">0.2</span><span class="op">)</span><span class="op">]</span><span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">&lt;-</span> <span class="fu"><a href="tdm_dt.max.html">tdm_dt.max</a></span><span class="op">(</span><span class="va">input</span>, methods<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dr"</span><span class="op">)</span>, det.pd<span class="op">=</span><span class="cn">TRUE</span>, interpolate<span class="op">=</span><span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                 max.days<span class="op">=</span><span class="fl">10</span>, df<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">output.data</span><span class="op">&lt;-</span> <span class="fu"><a href="tdm_cal.sfd.html">tdm_cal.sfd</a></span><span class="op">(</span><span class="va">input</span>,make.plot<span class="op">=</span><span class="cn">TRUE</span>,df<span class="op">=</span><span class="cn">FALSE</span>,wood<span class="op">=</span><span class="st">"Coniferous"</span>, decimals <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">input</span><span class="op">&lt;-</span> <span class="va">output.data</span><span class="op">$</span><span class="va">sfd.dr</span><span class="op">$</span><span class="va">sfd</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">output</span><span class="op">&lt;-</span> <span class="fu">out.data</span><span class="op">(</span>input<span class="op">=</span><span class="va">input</span>, vpd.input<span class="op">=</span><span class="va">vpd</span>, sr.input<span class="op">=</span><span class="va">sr</span>, prec.input<span class="op">=</span><span class="va">preci</span>,</span></span>
<span class="r-in"><span>                  low.sr <span class="op">=</span> <span class="fl">150</span>, peak.sr<span class="op">=</span><span class="fl">300</span>, vpd.cutoff<span class="op">=</span> <span class="fl">0.5</span>, prec.lim<span class="op">=</span><span class="fl">1</span>,</span></span>
<span class="r-in"><span>                  method<span class="op">=</span><span class="st">"env.filt"</span>, max.quant<span class="op">=</span><span class="fl">0.99</span>, make.plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">output</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Richard Peters, Christoforos Pappas, Alexander Hurley, Kathy Steppe.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

